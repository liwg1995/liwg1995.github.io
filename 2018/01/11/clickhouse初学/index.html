<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="clickhouse," />





  <link rel="alternate" href="/atom.xml" title="禹都一只猫" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="https://images.lwg1995.cn/favicon.ico?v=5.1.2" />






<meta name="description" content="clickhouse   https://clickhouse.yandex/tutorial.html  快速搭建集群参考     https://clickhouse.yandex/reference_en.html  官网文档    https://habrahabr.ru/company/smi2/blog/317682/ 关于集群配置参考   Clickhouse  基本介绍Clickh">
<meta name="keywords" content="clickhouse">
<meta property="og:type" content="article">
<meta property="og:title" content="clickhouse初学">
<meta property="og:url" content="http://blog.olei.me/2018/01/11/clickhouse初学/index.html">
<meta property="og:site_name" content="禹都一只猫">
<meta property="og:description" content="clickhouse   https://clickhouse.yandex/tutorial.html  快速搭建集群参考     https://clickhouse.yandex/reference_en.html  官网文档    https://habrahabr.ru/company/smi2/blog/317682/ 关于集群配置参考   Clickhouse  基本介绍Clickh">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-01-16T03:00:03.621Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="clickhouse初学">
<meta name="twitter:description" content="clickhouse   https://clickhouse.yandex/tutorial.html  快速搭建集群参考     https://clickhouse.yandex/reference_en.html  官网文档    https://habrahabr.ru/company/smi2/blog/317682/ 关于集群配置参考   Clickhouse  基本介绍Clickh">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.olei.me/2018/01/11/clickhouse初学/"/>





  <title>clickhouse初学 | 禹都一只猫</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/liwg1995"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">禹都一只猫</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">逐梦，努力，乐观，追求</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.olei.me/2018/01/11/clickhouse初学/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="olei.me">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://secure.gravatar.com/avatar/8e3ecfd364a177a21e7759d39861c630?s=320&d=identicon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="禹都一只猫">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">clickhouse初学</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-11T17:46:25+08:00">
                2018-01-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2018/01/11/clickhouse初学/#SOHUCS" itemprop="discussionUrl">
                  <span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="2018/01/11/clickhouse初学/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="clickhouse"><a href="#clickhouse" class="headerlink" title="clickhouse"></a>clickhouse</h2><p>   <a href="">https://clickhouse.yandex/tutorial.html</a>  快速搭建集群参考 </p>
<p>   <a href="">https://clickhouse.yandex/reference_en.html </a> 官网文档</p>
<p>   <a href="">https://habrahabr.ru/company/smi2/blog/317682/</a> 关于集群配置参考  </p>
<h3 id="Clickhouse-基本介绍"><a href="#Clickhouse-基本介绍" class="headerlink" title="Clickhouse  基本介绍"></a>Clickhouse  基本介绍</h3><pre><code>Clickhouse 是属于OLAP(联机分析处理)开源的列存储数据管理系统。
</code></pre><h4 id="特点："><a href="#特点：" class="headerlink" title="特点："></a>特点：</h4><pre><code>可以线性扩展
简单，方便 
高度可靠的 
容错(支持多主机异步复制，可以跨多个数据中心部署，单个节点或整个数据中心的停机时间不会影响系统的读写可用性)
</code></pre><a id="more"></a>
<h4 id="功能及应用介绍"><a href="#功能及应用介绍" class="headerlink" title="功能及应用介绍"></a>功能及应用介绍</h4><table>
<thead>
<tr>
<th style="text-align:left">功能</th>
<th style="text-align:center">应用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">深度列存储</td>
<td style="text-align:center">Web  app 分析</td>
</tr>
<tr>
<td style="text-align:left">向量化查询执行(vectorized query  execution)</td>
<td style="text-align:center">广告网络和实时出价</td>
</tr>
<tr>
<td style="text-align:left">数据压缩</td>
<td style="text-align:center">电信</td>
</tr>
<tr>
<td style="text-align:left">并行和分布式查询</td>
<td style="text-align:center">信息安全</td>
</tr>
<tr>
<td style="text-align:left">实时数据注入</td>
<td style="text-align:center">监测和遥测</td>
</tr>
</tbody>
</table>
<h3 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h3><pre><code>1.    不支持事务
2.    没有update 和delete 
3.    支持的操作系统有限(只支持ubuntu)
</code></pre><h3 id="Clickhouse-安装部署"><a href="#Clickhouse-安装部署" class="headerlink" title="Clickhouse 安装部署"></a>Clickhouse 安装部署</h3><pre><code>1.    环境准备
三台4c8G，分别为10.39.1.36，10.39.1.37，10.39.1.40 ubuntu 14.04.x86x64 
2.    安装
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv E0C56BD4 
sudo mkdir -p /etc/apt/sources.list.d
echo &quot;deb http://repo.yandex.ru/clickhouse/trusty stable main&quot; |
sudo tee /etc/apt/sources.list.d/clickhouse.list
sudo apt-get update
sudo apt-get install clickhouse-server-common clickhouse-client  
sudo service clickhouse-server start  单机版本就可以直接启动使用了。
</code></pre><h4 id="集群配置"><a href="#集群配置" class="headerlink" title="集群配置"></a>集群配置</h4><pre><code>ClickHouse deployment to cluster
ClickHouse cluster is a homogenous cluster. Steps to set up

1. Install ClickHouse server on all machines of the cluster
2. Set up cluster configs in configuration file
3. Create local tables on each instance
4. Create a Distributed table
  clickhouse-client 客户端软件，集群的安装的可以选择，
  clickhouse-server-common 服务端软件，必须安装
  clickhouse-compressor    数据压缩软件，集群的话必须安装
</code></pre><h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><pre><code>/etc/clickhouse-server/
 config.xml 配置文件
 users.xml 用户权限配置文件
 分布式查询集群或者复制需要单独创建一个新的文件
 touch  /etc/metrika.xml  
 (可以参考) 
</code></pre><p><a href="">https://clickhouse.yandex/reference_en.html#External dictionaries </a><br><a href="">https://clickhouse.yandex/reference_en.html#Data%20replication </a> </p>
<pre><code> 分布式集群配置
 vim /etc/metrika.xml
  &lt;yandex&gt;
   &lt;clickhouse_remote_servers&gt;
&lt;enncloud&gt;
    &lt;shard&gt;
        &lt;weight&gt;1&lt;/weight&gt;
        &lt;internal_replication&gt;false&lt;/internal_replication&gt;
        &lt;replica&gt;
            &lt;host&gt;clickhouse01&lt;/host&gt;
            &lt;port&gt;9000&lt;/port&gt;
        &lt;/replica&gt;
        &lt;replica&gt;
            &lt;host&gt;clickhouse02&lt;/host&gt;
            &lt;port&gt;9000&lt;/port&gt;
        &lt;/replica&gt;
        &lt;replica&gt;
            &lt;host&gt;clickhouse03&lt;/host&gt;
            &lt;port&gt;9000&lt;/port&gt;
        &lt;/replica&gt;
    &lt;/shard&gt;
    &lt;shard&gt;
        &lt;weight&gt;3&lt;/weight&gt;
        &lt;internal_replication&gt;false&lt;/internal_replication&gt;
        &lt;replica&gt;
            &lt;host&gt;clickhouse01&lt;/host&gt;
            &lt;port&gt;9000&lt;/port&gt;
        &lt;/replica&gt;
        &lt;replica&gt;
            &lt;host&gt;clickhouse02&lt;/host&gt;
            &lt;port&gt;9000&lt;/port&gt;
        &lt;/replica&gt;
        &lt;replica&gt;
            &lt;host&gt;clickhouse03&lt;/host&gt;
            &lt;port&gt;9000&lt;/port&gt;
        &lt;/replica&gt;
    &lt;/shard&gt;
&lt;/enncloud&gt;
&lt;/clickhouse_remote_servers&gt;
&lt;networks&gt;
  &lt;ip&gt;::/0&lt;/ip&gt;
 &lt;/networks&gt;


 &lt;clickhouse_compression&gt;
   &lt;min_part_size&gt;10000000000&lt;/min_part_size&gt;
   &lt;min_part_size_ratio&gt;0.01&lt;/min_part_size_ratio&gt;
   &lt;method&gt;lz4&lt;/method&gt;
&lt;/clickhouse_compression&gt;

&lt;/yandex&gt;

关于&lt;internal_replication&gt;false&lt;/internal_replication&gt; false 和true 的设置的区别
如果设置为true，则写操作将选择第一个健康副本并将数据写入它。如果分布式表”查看”复制表，则使用此选项，换句话说，如果将写入数据的将复制它们本身。 

 如果设置为false(默认值) 则将数据写入所有副本。这意味着分布式表复制数据本身，这比使用复制更槽糕，因为没有检查副本的一致性，并且随着时间的推移它们会包含稍微不同的数据。

关闭一台机器，其他机器还是分布式查询。

测试： 
 在所有的节点上创建test 表
 CREATE TABLE test (FlightDate Date,Year UInt16) ENGINE = MergeTree(FlightDate,   (Year, FlightDate), 8192);

 创建分布式表并且关联本地表
 CREATE TABLE test_all AS test ENGINE = Distributed(enncloud, default, test, rand())

往分布式表插入数据，然后在其他节点查询
insert into test_all (FlightDate,Year)values(&apos;2013-10-12&apos;,2013);

可以抓包查询是否是分布式查询  tcpdump -i any -s 0 -l -w - dst port 9000  
4.    复制的配置
   &lt;yandex&gt;
   &lt;clickhouse_remote_servers&gt;
  &lt;perftest_1shards_3replicas&gt;
    &lt;shard&gt;
        &lt;replica&gt;
            &lt;host&gt;clickhouse01&lt;/host&gt;
            &lt;port&gt;9000&lt;/port&gt;
         &lt;/replica&gt;
         &lt;replica&gt;
            &lt;host&gt;clickhouse02&lt;/host&gt;
            &lt;port&gt;9000&lt;/port&gt;
         &lt;/replica&gt;
         &lt;replica&gt;
            &lt;host&gt;clickhouse03&lt;/host&gt;
            &lt;port&gt;9000&lt;/port&gt;
         &lt;/replica&gt;
    &lt;/shard&gt;
   &lt;/perftest_1shards_3replicas&gt;
 &lt;/clickhouse_remote_servers&gt;

&lt;macros&gt;
   &lt;shard&gt;02&lt;/shard&gt;
   &lt;replica&gt;10.39.1.36&lt;/replica&gt;
&lt;/macros&gt;

&lt;networks&gt;
   &lt;ip&gt;::/0&lt;/ip&gt;
&lt;/networks&gt;

&lt;clickhouse_compression&gt;
   &lt;min_part_size&gt;10000000000&lt;/min_part_size&gt;
   &lt;min_part_size_ratio&gt;0.01&lt;/min_part_size_ratio&gt;
   &lt;method&gt;lz4&lt;/method&gt;
&lt;/clickhouse_compression&gt;

&lt;zookeeper-servers&gt;
     &lt;node index=&quot;1&quot;&gt;
        &lt;host&gt;10.39.1.36&lt;/host&gt;
        &lt;port&gt;2181&lt;/port&gt;
    &lt;/node&gt;
&lt;/zookeeper-servers&gt;

&lt;/yandex&gt;

配置详解
 shard 碎片标识符，

&lt;replica&gt;10.39.1.36&lt;/replica&gt; 10.39.1.36 是标识符，可以看做是副本标识符，是独一无二的，每个节点的标识符为本机的ip，这样的话，三个节点的话，每个配置的副本标识符将为它自身的ip地址。 

创建复制表
CREATE TABLE ontime_replica (FlightDate Date,Year UInt16) ENGINE = ReplicatedMergeTree(&apos;/clickhouse_perftest/tables/ontime_replica&apos;,&apos;{replica}&apos;,FlightDate,(Year, FlightDate),8192);

插入数据，在其他节点解析查询  
</code></pre><h4 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h4><pre><code>启用远程接口访问编辑 config.xml 
 &lt;listen_host&gt;::&lt;/listen_host&gt; 

1.    HTTP  interface  
 默认情况下，clcikhouse 服务器在端口8123 监听HTTP。 
 URL 长度限制为16KB 

 如果成功，则返回响应码200 
 如果失败，则返回响应码500 

 使用http interface 接口创建表插入数据并删除表
root@clickhouse01:~# echo &apos;CREATE TABLE abc (a UInt8) ENGINE = Memory&apos; | POST &apos;http://10.39.1.36:8123/&apos;
root@clickhouse01:~# echo &apos;INSERT INTO abc VALUES (1),(2),(3)&apos; | POST &apos;http://10.39.1.36:8123/&apos;
root@clickhouse01:~# echo &apos;(4),(5),(6)&apos; | POST &apos;http://10.39.1.36:8123/?query=INSERT INTO abc VALUES&apos;
 root@clickhouse01:~# echo &apos;(7),(8),(9)&apos; | POST &apos;http://10.39.1.36:8123/?query=INSERT INTO abc FORMAT Values&apos;
 格式转换TabSeparated
 root@clickhouse01:~# echo -ne &apos;10\n11\n12\n&apos; | POST &apos;http://10.39.1.36:8123/?query=INSERT INTO abc FORMAT TabSeparated&apos;  
 查询的结果输出如下 
root@clickhouse01:~# GET &apos;http://10.39.1.36:8123/?query=SELECT a FROM abc&apos;
 1
 2
 3
 10
 11
 12
 7
 8
 9
 4
 5
 6


删除表
echo &apos;DROP TABLE abc&apos; | POST &apos;http://10.39.1.36:8123/&apos;


2.    JDBC driver 
   https://github.com/yandex/clickhouse-jdbc 

3.    Third-party client libraries 

4.    Command-line client
</code></pre><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><pre><code> 系统中有两种类型的解析器：一个完整的SQL 解析器(一个递归下降解析器)和一个数据格式分析器（一个快速流分析器）。在所有情况下，除了插入查询，只有完整的SQL解析器使用。 

  创建数据库
 CREATE DATABASE [IF NOT EXISTS] db_name

  创建表
   CREATE [TEMPORARY] TABLE [IF NOT EXISTS] [db.]name
   (
name1 [type1] [DEFAULT|MATERIALIZED|ALIAS expr1],
name2 [type2] [DEFAULT|MATERIALIZED|ALIAS expr2],
...
  ) ENGINE = engine


  创建视图
  CREATE [MATERIALIZED] VIEW [IF NOT EXISTS] [db.]name [ENGINE = engine] [POPULATE] AS SELECT ...
</code></pre><h4 id="表引擎"><a href="#表引擎" class="headerlink" title="表引擎"></a>表引擎</h4><pre><code>    建议使用来自MergeTree家族的存储引擎(LSM树)
    表的存储引擎如下：
1.    TinyLog
  最简单的表引擎，它将数据存储在磁盘上，每列存储在单独的压缩文件中。写入时，数据会追加到文件的末尾。
  并发数据访问不受任何限制： 
  如果您正在从表中读取并以相同的查询写入，读操作将会出现错误。
  如果您同时在多个查询中写入表，数据将被破坏。
  使用该表的典型方式是一次写入：首先只是写入一次数据，然后根据需要读取数据，查询在单个流中执行，该引擎是用于相对较小的表，（最多可推荐1,000,000行）
  适合需要小表，不支持索引。 


 2.    Log 
Log 与Tinylog不同之处在于，一个小文件的“标记”驻留在列文件中。这些标记写在每个数据块上，并包含偏移量，在哪里开始读取文件以便跳过指定的行数。这使得可以在多个线程中读取表数据。对于并发数据访问，读取操作可以同时执行。 
Log 引擎不支持索引。类似的，如果写入表失败，则表被损坏，从其读取返回错误，log引擎适用于临时数据，一次写入表以及测试或者演示目的。 
3.    Memory 
 内存引擎将数据以未压缩格式存储在RAM 中。数据以读取时接收的格式完全相同的形式存储。并发数据访问同步，锁定很短：读写操作不会阻塞。
不支持索引，阅读并行化。 
4.    Merge 
 合并引擎不会自己存储数据，而是允许同时从任意数量的其他表读取数据。 
 读数据自动并行化。不支持写入表。读取时，使用实例读取的表的索引(如果存在)。合并引擎接受参数：数据库名称和表的正则表达式。例：
 Merge(hits, &apos;^WatchLog&apos;) 
 数据库将从“hits”数据库中的表读取，名称与正则表示‘^watchLlog’ 匹配。
 而不是数据库名称，您可以使用返回字符串的常量表达式。例如，currentDatabaase(). 

 正则表达式是re2(类似于PCRE)，区分大小写。
 选择要读取的表时，即使与正则表达式匹配，也不会选择合并表本身。为了避免循环。 



虚拟列
虚拟列是由表引擎提供的列，而不考虑定义。（create table 中未指定，但他们对于select 是可以访问的）

虚拟列与普通列的不同之处在于：
它们没有在表定义中指定，
无法使用insert 将数据添加到它们。
当使用insert 而不指定列表时，虚拟列将被忽略。 

合并表包含String类型的虚拟列_table。 （如果表已经有一个&apos;_table&apos;列，虚拟列名为&apos;_table1&apos;，如果它已经有&apos;_table1&apos;，它被命名为&apos;_table2&apos;，依此类推）。它包含表的名称从中读取数据。

 如果WHERE或PREWHERE子句包含不依赖于其他表列（作为连接元素之一或整个表达式）的“_table”列的条件，则将这些条件用作索引。条件是对表名的数据集进行读取数据，读操作将仅从触发条件的那些表执行。
5.    分布式引擎
分布式引擎不存储数据本身，但允许在多个服务器上进行分布式查询处理。读数自动并行化。在读取期间，使用远程服务器的表索引。 
分布式引擎接受参数：服务器器配置文件中的集群名称，远程数据库的名称，远程表的名称
例子：
   Distributed(logs, default, hits[, sharding_key])
  数据将从“日志”集群中的所有服务器从集群中每个服务器上的”default。hits” 表中读取。数据不仅被读取，而且在远程服务器上进行部分处理(在可能的范围内)
  例如，对于使用group by 的查询，数据将在远程服务器聚合，聚合函数的中间状态将发送到请求者服务器，那么数据将进一步汇总

 集群将数据写入的两种方法：
   1.    首先，你可以定义哪些服务器写入哪些数据，并直接在每个分片上执行写入。（在分片表”查看“的表中执行insert）这是最优的解决方案。因为数据可以完全独立写入不同的分片
   2.    其次，你可以在分布式表中执行insert，在这种情况下，表将通过服务器本身分发插入的数据。 
 6.    MergeTree 
     Mergetree 是clickhouse 最近的表引擎，它支持主键索引和日期，并提供了可能性，实时更新数据。
   Example without sampling support:
   MergeTree(EventDate, (CounterID, EventDate), 8192)

   Example with sampling support:
   MergeTree(EventDate, intHash32(UserID), (CounterID, EventDate, intHash32(UserID)), 8192)
   一个mergetree 型表必须有一个单独的列包含日期，在这个例子中，它是eventdate 的日期列的类型必须是日期。 
    7.    CollapsingMergeTree 
   该引擎与MergeTree 不同之处在于它允许自动删除，或者合并时“折叠”某些行对
   例子：
   CollapsingMergeTree(EventDate, (CounterID, EventDate, intHash32(UniqID), VisitID), 8192, Sign) 

  在这里sign 是一个列，old 值为-1，new 值为1 
  合并时，每组连续相同的主键值(用于排序数据的列)减少为不超过一行，列值为(sign_column=-1), 不超过一行，列值“sign_column=1”.(更改日志中的条目自己折叠)

  8.    SummingMergeTree 
       该存储引擎与MergeTree 的不同之处在于它在合并时总计数据
       SummingMergeTree(EventDate, (OrderID, EventDate, BannerID, ...), 8192)

  9.    AggregatingMergeTree 
  它与MergreTree 不同之处在于，合并将存储在表中的聚合函数的状态组合为具有相同主键值的行。 
 例子：
 CREATE MATERIALIZED VIEW test.basic
 ENGINE = AggregatingMergeTree(StartDate, (CounterID, StartDate), 8192)
 AS SELECT
CounterID,
StartDate,
sumState(Sign)    AS Visits,
uniqState(UserID) AS Users
FROM test.visits
GROUP BY CounterID, StartDate;


 INSERT INTO test.visits ...

 SELECT
    StartDate,
    sumMerge(Visits) AS Visits,
uniqMerge(Users) AS Users
 FROM test.basic
 GROUP BY StartDate
 ORDER BY StartDate;

  10.    ReplacingMergeTree 
   它与MergeTree 不同之处在于，它可以在合并时通过主键重复数据删除数据
   例子：
   ReplacingMergeTree(EventDate, (OrderID, EventDate, BannerID, ...), 8192, ver)

  11.    NULL 
    当写入null 表时，数据将被忽略，从null 表中读取，响应为空
    但是，你可以在null表上创建实例视图，因为写入表的数据将在视图中显示

 12.    View 
   用于实现视图，它不存储数据，而只存储指定的select 查询。从表读取时，它会运行此查询(并从表中删除所有不必要的列)

   a)    MaterializedView 
     用于实现物化视图。对于存储数据，它使用在创建视图时指定的不同引擎。它只是使用这个引擎。

13.    Set 
   始终在RAM的数据集。你可以使用insert 在表中插入数据。新元素将被添加到数据集中，而重复的元素将被忽略。
   数据总是位于RAM中，对于insert，插入的数据块也会写入到磁盘上的表目录。当启动服务器时，这些数据被加载到RAM中。重启后，数据保持原样。

 对于服务器重新启动，磁盘上的数据块可能会丢失或损坏。在后一种情况，你可能需要手动删除带有损坏数据的文件。 

14.    Join 
  一个总是位于RAM 中的JOIN 数据结构 
  Join(ANY|ALL, LEFT|INNER, k1[, k2, ...]) 

15.    Buffer 
  缓存数据写入RAM，定期将其刷新到另一个表。在读操作期间，数据从缓冲器和另一个表同时读取。 
  例子： 
  CREATE TABLE merge.hits_buffer AS merge.hits ENGINE = Buffer(merge, hits, 16, 10, 100, 10000, 1000000, 10000000, 100000000)
  最大1.6GB 的内存消耗 

16.    Data replication 
     ReplicatedMergeTree
     ReplicatedCollapsingMergeTree
     ReplicatedAggregatingMergeTree
     ReplicatedSummingMergeTree

     MergeTree 系列中的表仅支持复制。复制在单个表的级别上工作，而不是整个服务器。服务器可以同时存储复制表和非复制表。 
</code></pre><h4 id="系统表"><a href="#系统表" class="headerlink" title="系统表"></a>系统表</h4><pre><code>system.databases
system.tables

system.processes

system.clusters
cluster String      - Cluster name.
shard_num UInt32    - Number of a shard in the cluster, starting from 1.
shard_weight UInt32 - Relative weight of a shard when writing data.
replica_num UInt32  - Number of a replica in the shard, starting from 1.
host_name String    - Host name as specified in the config.
host_address String - Host&apos;s IP address obtained from DNS.
port UInt16         - The port used to access the server.
user String         - The username to use for connecting to the server.

system.merges
system.settings

system.zookeeper
</code></pre><h4 id="表函数"><a href="#表函数" class="headerlink" title="表函数"></a>表函数</h4><pre><code>1.    merge 
2.    remote 
</code></pre><h4 id="数据格式"><a href="#数据格式" class="headerlink" title="数据格式"></a>数据格式</h4><pre><code>TabSeparated
 TabSeparatedWithNames
 TabSeparatedWithNamesAndTypes
TabSeparatedRaw
BlockTabSeparated
CSV
CSVWithNames
RowBinary
Pretty
PrettyCompact
PrettyCompactMonoBlock
PrettySpace
PrettyNoEscapes
PrettyCompactNoEscapes
PrettySpaceNoEscapes
Vertical
Values
JSON
JSONCompact
JSONEachRow
TSKV
XML
Null
</code></pre><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><pre><code>1.    整数
  UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64
2.    浮点数
  Float32, Float64 
3.    字符串
    任意长度的字符串，长度不限于此，该值可以包含任意字节集，包括空字节。字符串类型替换其他DBMS中类型varchar，blob，clob 和其他类型。 

  Cliclhouse 没有编码的概念，建议使用UTF-8编码， 
4.    FixedString(N) 
   N字节固定长度字符串，N必须是严格正数的自然数。 
5.    Date
   日期存储没有时区，最小值输出为0000-00-00 
6.    DateTime 
  允许将值与日期类型保存在相同的范围，最小输出为 0000-00-00 00:00:00 
7.    枚举 
  Enum8 or Enum16
8.    Array(T) 
  不建议使用多维数组，不被很好的支持
9.    元组
   Tuple(T1, T2, ...)
10.    嵌套的数据结构
    Nested(Name1 Type1, Name2 Type2, ...) 
11.    聚合函数
   AggregateFunction(name, types_of_arguments...) 
</code></pre><p>   <a href=""> https://clickhouse.yandex/reference_en.html#AggregatingMergeTree </a> </p>
<pre><code>12.    特殊的数据类型
  特殊的数据类型值无法保存到结果中的表输出，而是用作运行查询的中间结果。 
13.    set 
14.    Boolean values 
     使用uint8 类型限制的值0 和值 1 
</code></pre><h4 id="分布式数据查询"><a href="#分布式数据查询" class="headerlink" title="分布式数据查询"></a>分布式数据查询</h4><pre><code>10.1 分布式集群测试
  查询集群状态
  select * from system.clusters 


使用官网的测试数据
</code></pre><p><a href="">https://raw.githubusercontent.com/yandex/ClickHouse/master/doc/example_datasets/1_ontime.txt </a> </p>
<pre><code> CREATE TABLE a_test 
 (
Year UInt16, 
Quarter UInt8, 
Month UInt8, 
DayofMonth UInt8, 
DayOfWeek UInt8, 
FlightDate Date, 
UniqueCarrier FixedString(7), 
AirlineID Int32, 
Carrier FixedString(2), 
TailNum String, 
FlightNum String, 
OriginAirportID Int32, 
OriginAirportSeqID Int32, 
OriginCityMarketID Int32, 
Origin FixedString(5), 
OriginCityName String, 
OriginState FixedString(2), 
OriginStateFips String, 
OriginStateName String, 
OriginWac Int32, 
DestAirportID Int32, 
DestAirportSeqID Int32, 
DestCityMarketID Int32, 
Dest FixedString(5), 
DestCityName String, 
DestState FixedString(2), 
DestStateFips String, 
DestStateName String, 
DestWac Int32, 
CRSDepTime Int32, 
DepTime Int32, 
DepDelay Int32, 
DepDelayMinutes Int32, 
DepDel15 Int32, 
DepartureDelayGroups String, 
DepTimeBlk String, 
TaxiOut Int32, 
WheelsOff Int32, 
WheelsOn Int32, 
TaxiIn Int32, 
CRSArrTime Int32, 
ArrTime Int32, 
ArrDelay Int32, 
ArrDelayMinutes Int32, 
ArrDel15 Int32, 
ArrivalDelayGroups Int32, 
ArrTimeBlk String, 
Cancelled UInt8, 
CancellationCode FixedString(1), 
Diverted UInt8, 
CRSElapsedTime Int32, 
ActualElapsedTime Int32, 
AirTime Int32, 
Flights Int32, 
Distance Int32, 
DistanceGroup UInt8, 
CarrierDelay Int32, 
WeatherDelay Int32, 
NASDelay Int32, 
SecurityDelay Int32, 
LateAircraftDelay Int32, 
FirstDepTime String, 
TotalAddGTime String, 
LongestAddGTime String, 
DivAirportLandings String, 
DivReachedDest String, 
DivActualElapsedTime String, 
DivArrDelay String, 
DivDistance String, 
Div1Airport String, 
Div1AirportID Int32, 
Div1AirportSeqID Int32, 
Div1WheelsOn String, 
Div1TotalGTime String, 
Div1LongestGTime String, 
Div1WheelsOff String, 
Div1TailNum String, 
Div2Airport String, 
Div2AirportID Int32, 
Div2AirportSeqID Int32, 
Div2WheelsOn String, 
Div2TotalGTime String, 
Div2LongestGTime String, 
Div2WheelsOff String, 
Div2TailNum String, 
Div3Airport String, 
Div3AirportID Int32, 
Div3AirportSeqID Int32, 
Div3WheelsOn String, 
Div3TotalGTime String, 
Div3LongestGTime String, 
Div3WheelsOff String, 
Div3TailNum String, 
Div4Airport String, 
Div4AirportID Int32, 
Div4AirportSeqID Int32, 
Div4WheelsOn String, 
Div4TotalGTime String, 
Div4LongestGTime String, 
Div4WheelsOff String, 
Div4TailNum String, 
Div5Airport String, 
Div5AirportID Int32, 
Div5AirportSeqID Int32, 
Div5WheelsOn String, 
Div5TotalGTime String, 
Div5LongestGTime String, 
Div5WheelsOff String, 
Div5TailNum String
 ) ENGINE = MergeTree(FlightDate, (Year, FlightDate), 8192)

2. 创建分布式关联表
   CREATE TABLE a_all AS  a_test 
 ENGINE = Distributed(perftest_1shards_3replicas, default, a_test, rand());  

3.创建表和分布式关联表都需要在每个节点执行。 

4. 插入数据到分布式表，在其他节点查询
    下载的数据导入到a_all 表中
   for i in *.zip; do echo $i; unzip -cq $i &apos;*.csv&apos; | sed &apos;s/\.00//g&apos; | clickhouse-client --host=clickhouse01 --query=&quot;INSERT INTO a_all   FORMAT CSVWithNames&quot;; done

 在其他节点上查询并且监测是不是分布式    
抓包
      tcpdump -i any -s 0 -l -w - dst port 9000  
1. 查询总的数据 
         select count(*) from a_all;


2. 查询1987-1991年每天的航班统计
 SELECT DayOfWeek, count(*) AS c FROM a_all WHERE Year &gt;= 1987 AND Year &lt;= 1991 GROUP BY DayOfWeek ORDER BY c DESC;

3. 查询延误在一个小时以上出发的城市
 SELECT OriginCityName, count() AS c, avg(DepDelay &gt;  60) AS delays FROM a_all GROUP BY OriginCityName HAVING c &gt;  100000 ORDER BY delays DESC LIMIT 20

4. 查询1991 年最后欢迎的目的地
  SELECT     OriginCityName,     DestCityName,     count(*) AS flights,     bar(flights, 0, 20000, 40) FROM ontime_all WHERE Year = 1991 GROUP BY OriginCityName, DestCityName ORDER BY flights DESC LIMIT 20

SELECT     OriginCityName &lt; DestCityName ? OriginCityName : DestCityName AS a,     OriginCityName &lt; DestCityName ? DestCityName : OriginCityName AS b,     count(*) AS flights,     bar(flights, 0, 40000, 40) FROM a_all WHERE Year =  1991 GROUP BY a, b ORDER BY flights DESC LIMIT 20


5. 最受欢迎的出发城市
    SELECT OriginCityName, count(*) AS flights FROM a_all GROUP BY OriginCityName ORDER BY flights DESC LIMIT 20  

6. 创建array   join 
      允许使用数组或嵌套数据结构执行join。

   CREATE TABLE arrays_test (s String, arr Array(UInt8)) ENGINE = Memory

   INSERT INTO arrays_test VALUES (&apos;Hello&apos;, [1,2]), (&apos;World&apos;, [3,4,5]), (&apos;Goodbye&apos;, []) 

  SELECT * FROM arrays_test 

  SELECT s, arr FROM arrays_test ARRAY JOIN arr 

  SELECT s, arr, a FROM arrays_test ARRAY JOIN arr AS a 

  SELECT s, arr, a, num, mapped FROM arrays_test ARRAY JOIN arr AS a, arrayEnumerate(arr) AS num, arrayMap(x -&gt; x + 1, arr) AS mapped


 数组联接也与嵌套的数据结构一起工作，例子
  CREATE TABLE nested_test (s String, nest Nested(x UInt8, y UInt32)) ENGINE = Memory 

  INSERT INTO nested_test VALUES (&apos;Hello&apos;, [1,2], [10,20]), (&apos;World&apos;, [3,4,5], [30,40,50]), (&apos;Goodbye&apos;, [], [])
SELECT * FROM nested_test

 SELECT s, nest.x, nest.y FROM nested_test ARRAY JOIN nest

 SELECT s, nest.x, nest.y FROM nested_test ARRAY JOIN nest.x, nest.y

 SELECT s, nest.x, nest.y FROM nested_test ARRAY JOIN nest.x

 使用arrayEnumerate 函数

  SELECT s, n.x, n.y, nest.x, nest.y, num FROM nested_test ARRAY JOIN nest AS n, arrayEnumerate(nest.x) AS num
</code></pre><h4 id="集群复制"><a href="#集群复制" class="headerlink" title="集群复制"></a>集群复制</h4><pre><code>创建复制表：
     CREATE TABLE ontime_replica (FlightDate Date,Year UInt16) ENGINE = ReplicatedMergeTree(&apos;/clickhouse_perftest/tables/ontime_replica&apos;,&apos;{replica}&apos;,FlightDate,(Year, FlightDate),8192);  

 insert into ontime_replica (FlightDate,Year)values(&apos;2017-04-18&apos;,2017); 
在其他节点查询
   select * from  ontime_replica  

 十一、 创建用户
    直接编辑user.xml 文件
    在&lt;user&gt; 这个范围中添加  &lt;/user&gt;
    如果使用明文密码，直接写入到下面的明文密码处 
    &lt;password&gt; 明文密码 &lt;/password&gt;.

   如果使用SHA256加密的密码，请使用如下配置 
   Example:    &lt;password_sha256_hex&gt;65e84be33532fb784c48129675f9eff3a682b27168c0ea744b2cf58ee02337c5&lt;/password_sha256_hex&gt;

  使用下面的命令生成密码： 
 PASSWORD=$(base64 &lt; /dev/urandom | head -c8); echo &quot;$PASSWORD&quot;; echo -n &quot;$PASSWORD&quot; | sha256sum | tr -d &apos;-&apos;
 第一行地密码是，第二行是加密过的密码 SHA256.

 例如如下配置
 &lt;dba&gt;   &lt;password_sha256_hex&gt;ef375dec86573b84efd45187966705c4a7b00d74c6eb8e4b8372e4ea9ebbe796&lt;/password_sha256_hex&gt;
           &lt;networks incl=&quot;networks&quot; /&gt;
           &lt;profile&gt;default&lt;/profile&gt;
           &lt;quota&gt;default&lt;/quota&gt;
           &lt;allow_databases&gt;
              &lt;database&gt;default&lt;/database&gt;
           &lt;/allow_databases&gt;
 &lt;/dba&gt;

权限配置: 
readonly 只读权限
default   有些权限
</code></pre><p>github <a href="">https://github.com/liwg1995/blong/blob/master/clickhouse%20.md</a></p>

      
    </div>
    
    
    
    


    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>禹都一只猫，热爱IT，支持原创</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="https://olei.me/content/uploadfile/tpl_options//dswx.png" alt="olei.me 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="https://olei.me/content/uploadfile/tpl_options//dszfb.jpg" alt="olei.me 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    olei.me
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://blog.olei.me/2018/01/11/clickhouse初学/" title="clickhouse初学">http://blog.olei.me/2018/01/11/clickhouse初学/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/clickhouse/" rel="tag"><i class="fa fa-tag"></i> clickhouse</a>
          
        </div>
      




      <div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JS库 sweetalert 可修改路径 -->
  <script type="text/javascript" src="http://jslibs.wuxubj.cn/sweetalert_mini/jquery-1.7.1.min.js"></script>
  <script src="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.min.js"></script>
  <link rel="stylesheet" type="text/css" href="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.mini.css">
  <p><span>本文标题:</span><a href="/2018/01/11/clickhouse初学/">clickhouse初学</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 olei.me 的个人博客">olei.me</a></p>
  <p><span>发布时间:</span>2018年01月11日 - 17:01</p>
  <p><span>最后更新:</span>2018年01月16日 - 11:01</p>
  <p><span>原始链接:</span><a href="/2018/01/11/clickhouse初学/" title="clickhouse初学">http://blog.olei.me/2018/01/11/clickhouse初学/</a>
    <span class="copy-path"  title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://blog.olei.me/2018/01/11/clickhouse初学/"  aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
	clipboard.on('success', $(function(){
	  $(".fa-clipboard").click(function(){
		swal({   
		  title: "",   
		  text: '复制成功',   
		  html: false,
		  timer: 500,   
		  showConfirmButton: false
	    });
	  });
    }));  
</script>


      
      </div>



      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/01/05/七牛云迁移至阿里云oss单机部署方式/" rel="next" title="七牛云迁移至阿里云oss单机部署方式">
                <i class="fa fa-chevron-left"></i> 七牛云迁移至阿里云oss单机部署方式
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/01/15/openvpn的搭建、使用以及设置分配用户密码/" rel="prev" title="openvpn的搭建、使用以及设置分配用户密码">
                openvpn的搭建、使用以及设置分配用户密码 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
<span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_fav">收藏夹</a>
<a class="jiathis_button_copy">复制网址</a>
<a class="jiathis_button_email">邮件</a>
<a class="jiathis_button_weixin">微信</a>
<a class="jiathis_button_qzone">QQ空间</a>
<a class="jiathis_button_tqq">腾讯微博</a>
<a class="jiathis_button_douban">豆瓣</a>
<a class="jiathis_button_share">一键分享</a>

<a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
var jiathis_config={
  data_track_clickback:true,
  summary:"",
  shortUrl:false,
  hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script>
<!-- JiaThis Button END -->
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="SOHUCS"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <img class="site-author-image" itemprop="image"
              src="https://secure.gravatar.com/avatar/8e3ecfd364a177a21e7759d39861c630?s=320&d=identicon"
              alt="olei.me" />
          
            <p class="site-author-name" itemprop="name">olei.me</p>
            <p class="site-description motion-element" itemprop="description">I like IT , I like python.</p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives">
            
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/liwg1995" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>GitHub</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:liwg@olei.me" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://sina.olei.me" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>微博</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="986728544" target="_blank" title="Q Q">
                  
                    <i class="fa fa-fw fa-qq"></i>Q Q</a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://olei.me/" title="禹都一只猫" target="_blank">禹都一只猫</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://music.olei.me" title="music" target="_blank">music</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#clickhouse"><span class="nav-number">1.</span> <span class="nav-text">clickhouse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Clickhouse-基本介绍"><span class="nav-number">1.1.</span> <span class="nav-text">Clickhouse  基本介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#特点："><span class="nav-number">1.1.1.</span> <span class="nav-text">特点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#功能及应用介绍"><span class="nav-number">1.1.2.</span> <span class="nav-text">功能及应用介绍</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缺点："><span class="nav-number">1.2.</span> <span class="nav-text">缺点：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Clickhouse-安装部署"><span class="nav-number">1.3.</span> <span class="nav-text">Clickhouse 安装部署</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#集群配置"><span class="nav-number">1.3.1.</span> <span class="nav-text">集群配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置文件"><span class="nav-number">1.3.2.</span> <span class="nav-text">配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#接口"><span class="nav-number">1.3.3.</span> <span class="nav-text">接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#语法"><span class="nav-number">1.3.4.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#表引擎"><span class="nav-number">1.3.5.</span> <span class="nav-text">表引擎</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#系统表"><span class="nav-number">1.3.6.</span> <span class="nav-text">系统表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#表函数"><span class="nav-number">1.3.7.</span> <span class="nav-text">表函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据格式"><span class="nav-number">1.3.8.</span> <span class="nav-text">数据格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据类型"><span class="nav-number">1.3.9.</span> <span class="nav-text">数据类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分布式数据查询"><span class="nav-number">1.3.10.</span> <span class="nav-text">分布式数据查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#集群复制"><span class="nav-number">1.3.11.</span> <span class="nav-text">集群复制</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-gg"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">olei.me</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.2</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  




  
    <script type="text/javascript">
    (function(){
      var appid = 'cysXDvmXD';
      var conf = 'd8fd353306473d6610ae9a203fd51537';
      var width = window.innerWidth || document.documentElement.clientWidth;
      if (width < 960) {
      window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){
        window.changyan.api.config({appid:appid,conf:conf})});
      }
    })();
    </script>
    <script type="text/javascript" src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script>
  





  





  

  

  

  

  

  

  
   <script>
     (function(i,s,o,g,r,a,m){
     i["DaoVoiceObject"]=r;
     i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},
     i[r].l=1*new Date();
     a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];
     a.async=1;
     a.src=g;
     a.charset="utf-8";
     m.parentNode.insertBefore(a,m)
     })(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/44c3c8bd.js","daovoice")
     daovoice('init', {
     app_id: "44c3c8bd"
     });
     daovoice('update');
   </script>
 

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
